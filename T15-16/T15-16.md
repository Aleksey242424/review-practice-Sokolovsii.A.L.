Вредоносное ПО: виды и принципы работы
1. Вирусы
Что это: Самовоспроизводящийся код, внедряющийся в легитимные файлы (EXE, DOC, DLL).

Принцип работы:

Заражение: Копирует себя в другие файлы при запуске зараженной программы.

Активация: Выполняется при открытии хостового файла (например, вирус в документе Word).

Полезная нагрузка: Повреждает данные, рассылает спам, создает бэкдоры.

Пример: CIH (Чернобыль), стирающий BIOS.

2. Трояны
Что это: Программы, маскирующиеся под полезный софт (утилиты, игры).

Принцип работы:

Обман пользователя: Устанавливаются вручную (например, с фишинговым вложением).

Скрытая функциональность:

Крадут данные (банковские реквизиты через Zeus).

Создают бэкдоры (Remote Access Trojan — RAT).

Загружают другие вредоносы.

Пример: Emotet, маскирующийся под PDF-документ.

3. Вымогатели (Ransomware)
Что это: Шифрует данные и требует выкуп за расшифровку.

Принцип работы:

Проникновение: Через уязвимости, трояны, фишинг.

Шифрование: Использует AES-256/RSA для блокировки файлов.

Требование выкупа: Сообщение с инструкциями (часто в криптовалюте).

Пример: WannaCry, использовавший уязвимость Windows SMB.

Принципы анализа вредоносного ПО
1. Статический анализ (без запуска)
Цель: Изучение кода/структуры без выполнения.

Методы:

Дизассемблирование: Преобразование бинарного кода в ассемблер (IDA Pro, Ghidra).

Анализ строк: Поиск URL, IP-адресов, ключей шифрования в бинарнике.

Исследование заголовков: Проверка секций PE-файла (например, подозрительные импорты WriteProcessMemory).

Энтропийный анализ: Обнаружение упакованного/шифрованного кода.

Преимущества: Безопасен, не требует запуска вредоноса.

Недостатки: Сложность против обфускации.

2. Динамический анализ (с запуском)
Цель: Наблюдение за поведением при выполнении.

Методы:

Песочницы: Автоматический анализ в изолированной среде (Cuckoo Sandbox, Any.run).

Отладка: Пошаговое выполнение кода (x64dbg, OllyDbg).

Мониторинг:

Системные вызовы (Process Monitor).

Сетевая активность (Wireshark).

Изменения в реестре/файлах.

Преимущества: Обход обфускации, выявление скрытого поведения.

Недостатки: Риск заражения, детектирование анализаторных сред.

Правила безопасности при исследовании ВПО
Изоляция среды:

Используйте виртуальные машины (VMware, VirtualBox) с отключенными общими папками.

Сеть: Режим Host-only или полная изоляция.

Аппаратная защита:

Отдельный компьютер для анализа без доступа к корпоративной сети.

Отключение USB-портов.

Контроль доступа:

Ограниченные права пользователя (не администратор).

Шифрование дисков (BitLocker, VeraCrypt).

Инструменты мониторинга:

Антивирусы с отложенным сканированием.

Системы предотвращения вторжений (IPS).

Работа с образцами:

Хеширование файлов (SHA-256) для отслеживания.

Хранение образцов в зашифрованных контейнерах.

Протокол реагирования:

Автоматические снимки ВМ перед запуском (snapshots).

Готовность к немедленному отключению питания.

Юридические аспекты:

Не анализировать образцы без правообладателя.

Запрет на распространение вредоносов.
