Currencies — 5
currency_data — 5
end_date — 4
start_date — 4
current_date — 3
formatted_date — 4
url — 4
response — 4
root — 5
date_record — 5
char_code — 5
value — 3
nominal — 4
normalized_value — 4
a — 1
b — 1
r — 1
op — 1
arr — 3
x — 1
m — 1
find_max  - 5
calc — 4

AVG
calc - 4
find_max — 8
AVG = 6


Комментарии
всего строк — 154
строк с комментариями — 64

Оценка комментариев
# Импорт необходимых библиотек — 1
# Для выполнения HTTP-запросов к API ЦБ РФ — 1
# Для выполнения HTTP-запросов к API ЦБ РФ — 1
# Для построения графиков — 1
# Для работы с датами — 1
# Для парсинга XML-данных — 1
# Список валют, которые мы будем анализировать (обновлен по заданию) — 1
# Датская крона, Канадский доллар, Новозеландский доллар, Злотый — 5
# Создаем словарь для хранения данных по валютам — 1
# Устанавливаем диапазон дат: последние 30 дней от текущей даты — 5
# Текущая дата — 1
# Дата 30 дней назад — 3
# Начинаем с начальной даты — 1
# Цикл по всем дням в диапазоне — 3
# Форматируем дату в формат, который понимает API ЦБ (дд/мм/гггг) — 4
# Формируем URL для запроса курсов валют на конкретную дату — 1
# Отправляем GET-запрос к API ЦБ — 1
# Указываем кодировку ответа — 1
# Проверяем, что запрос успешен (код 200) — 1
# Парсим XML-ответ — 1
# Получаем дату из атрибутов XML-документа — 3
# Ищем все элементы 'Valute' в XML — 2
# Получаем буквенный код валюты — 3
# Проверяем, есть ли эта валюта в нашем списке — 2
# Получаем значение курса и номинал — 3
# Заменяем запятую на точку для float — 3
# Номинал (например, 1, 10, 100 и т. д.) - 1
# Нормализуем курс (приводим к стоимости за 1 единицу валюты) — 3
# Добавляем данные в словарь — 3
# Дата записи — 1
# Нормализованное значение курса — 1
# Переходим к следующему дню — 1
# Сохраняем данные в Excel-файл — 3
# Создаем DataFrame из собранных данных  - 3
# Проверяем, что данные есть — 2
# Преобразуем дату в формат datetime и сортируем по дате — 3
# Сохраняем в отдельный лист Excel с именем валюты — 4
# Строим графики для каждой валюты — 4
# Создаем DataFrame из собранных данных — 4
# Проверяем, есть ли данные — 2
# Преобразуем и сортируем даты — 3
# Создаем график — 1
# Устанавливаем размер графика — 4
# Рисуем линию с точками — 2
# Маркеры в виде кружков — 4
# Сплошная линия — 3
# Толщина линии — 3
# Размер маркеров — 3
# Синий цвет — 1
# Заголовок графика — 1
# Размер шрифта — 1
# Отступ — 1
# Подписи осей — 1
# Настройка осей — 1
# Поворот подписей дат — 1
# Размер шрифта по оси Y — 1
# Включаем сетку с прозрачностью — 1
# Форматируем отображение дат на оси X — 1
# Оптимизируем расположение элементов — 3
# Сохраняем график в файл PNG — 1
# Показываем график — 1
# Файл с курсами валют  - 1
# Сохраненные графики — 1
